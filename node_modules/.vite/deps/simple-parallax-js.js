import {
  __toESM,
  require_react
} from "./chunk-JSZTVBPD.js";

// node_modules/simple-parallax-js/dist/react/simpleParallax.es.js
var import_react = __toESM(require_react());
var p = class _p {
  constructor() {
    this.callbacks = /* @__PURE__ */ new Set(), this.animationFrameId = null;
  }
  static getInstance() {
    return _p.instance || (_p.instance = new _p()), _p.instance;
  }
  register(t) {
    this.callbacks.add(t), this.animationFrameId === null && this.start();
  }
  unregister(t) {
    this.callbacks.delete(t), this.callbacks.size === 0 && this.animationFrameId !== null && this.stop();
  }
  start() {
    const t = () => {
      this.callbacks.forEach((n) => n()), this.animationFrameId = requestAnimationFrame(t);
    };
    this.animationFrameId = requestAnimationFrame(t);
  }
  stop() {
    this.animationFrameId !== null && (cancelAnimationFrame(this.animationFrameId), this.animationFrameId = null);
  }
};
var H = p.getInstance();
var B = (e) => {
  const [t, n] = (0, import_react.useState)(0), [r, i] = (0, import_react.useState)(false), o = (0, import_react.useRef)(null), s = (0, import_react.useCallback)(() => {
    o.current && n(o.current.height);
  }, []);
  return (0, import_react.useEffect)(() => {
    const d = () => {
      i(true), s();
    }, c = o.current;
    return c && (c.complete ? d() : c.addEventListener("load", d)), window.addEventListener("resize", s), () => {
      c && c.removeEventListener("load", d), window.removeEventListener("resize", s);
    };
  }, [e, s]), [o, t, r];
};
var G = (e, t) => e * t - e;
var O = (e, t) => Math.ceil(e / 100 * t - t / 2);
var W = (e, t) => {
  const { top: n, height: r } = e, i = -r, o = t;
  if (n < i)
    return 0;
  if (n > o)
    return 100;
  const s = (n - i) / (o - i) * 100;
  return Math.min(Math.max(s, 0), 100);
};
var Y = (e, t) => {
  switch (t) {
    case "up":
      return `0, ${e}px, 0`;
    case "right":
      return `${-e}px, 0, 0`;
    case "down":
      return `0, ${-e}px, 0`;
    case "left":
      return `${e}px, 0, 0`;
    case "up left":
      return `${e}px, ${e}px, 0`;
    case "up right":
      return `${-e}px, ${e}px, 0`;
    case "down left":
      return `${e}px, ${-e}px, 0`;
    case "down right":
      return `${-e}px, ${-e}px, 0`;
    default:
      return `0, ${e}px, 0`;
  }
};
var D = () => {
  const [e, t] = (0, import_react.useState)(null);
  return (0, import_react.useEffect)(() => {
    const n = () => {
      t(window.innerHeight);
    };
    if (typeof window < "u")
      return t(window.innerHeight), window.addEventListener("resize", n), () => {
        window.removeEventListener("resize", n);
      };
  }, []), e;
};
var Q = ({
  isLoaded: e,
  imageHeight: t,
  scale: n,
  boundingClientRect: r,
  orientation: i,
  maxTransition: o
}) => {
  const [s, d] = (0, import_react.useState)(0), [c, x] = (0, import_react.useState)(0), [g, b] = (0, import_react.useState)(""), [h, I] = (0, import_react.useState)(0), w = D();
  return (0, import_react.useEffect)(() => {
    if (!e)
      return;
    const l = G(t, n);
    d(l);
  }, [e, t, n]), (0, import_react.useEffect)(() => {
    if (!e || !w || !r)
      return;
    let l = W(r, w);
    o && (l = Math.min(l, 100 - o)), I(l);
  }, [e, r, w]), (0, import_react.useEffect)(() => {
    const l = O(h, s);
    x(l);
  }, [h, s]), (0, import_react.useEffect)(() => {
    const l = Y(c, i);
    b(l);
  }, [c, i]), g;
};
var U = (e = {}) => {
  const [t, n] = (0, import_react.useState)(false), r = (0, import_react.useRef)(null);
  return (0, import_react.useEffect)(() => {
    const i = new IntersectionObserver(
      (s) => {
        const [d] = s;
        d && (d.isIntersecting ? n(true) : n(false));
      },
      {
        ...e
      }
    ), { current: o } = r;
    return o && i.observe(o), () => {
      o && i.unobserve(o);
    };
  }, [e]), [r, t];
};
var _ = () => {
  const [e, t] = (0, import_react.useState)(false);
  return (0, import_react.useEffect)(() => {
    if (typeof window > "u")
      return;
    const n = window.matchMedia("(prefers-reduced-motion: reduce)");
    t(n.matches);
    const r = (i) => {
      t(i.matches);
    };
    return n.addEventListener("change", r), () => {
      n.removeEventListener("change", r);
    };
  }, []), e;
};
var J = "/Users/geoffrey/Desktop/perso/simpleParallax.js/src/react/index.tsx";
var X = ({
  delay: e = 0.4,
  orientation: t = "up",
  scale: n = 1.4,
  overflow: r = false,
  transition: i = "cubic-bezier(0,0,0,1)",
  maxTransition: o = null,
  children: s
}) => {
  var T;
  const d = t ?? "up", c = n ?? 1.2, x = (T = s == null ? void 0 : s.props) == null ? void 0 : T.src, [g, b] = (0, import_react.useState)(false), [h, I] = (0, import_react.useState)(0), [w, l] = (0, import_react.useState)(null), [P, V] = (0, import_react.useState)(""), [k, v] = (0, import_react.useState)(""), [y, z] = (0, import_react.useState)(false), f = _(), [$, A, N] = B(x), [j, F] = U({
    root: null,
    rootMargin: "0px",
    threshold: Array.from(Array(101).keys(), (m) => m / 100)
  }), S = Q({
    isLoaded: N,
    imageHeight: A,
    scale: c,
    boundingClientRect: w,
    orientation: d,
    maxTransition: o
  }), R = (0, import_react.useCallback)(() => {
    var m;
    if (!(!F && g || f) && (window.scrollY !== h || !g)) {
      const C = (m = $.current) == null ? void 0 : m.getBoundingClientRect();
      C && l(C), g || (b(true), setTimeout(() => {
        z(true);
      }, 50)), I(window.scrollY);
    }
  }, [h, F, $, g, f]);
  (0, import_react.useEffect)(() => {
    if (f) {
      V("");
      return;
    }
    let m = `translate3d(${S})`;
    r || (m += ` scale(${c})`), V(m);
  }, [S, c, r, f]), (0, import_react.useEffect)(() => {
    if (!i || !e || !y || f) {
      v("");
      return;
    }
    v(`transform ${e}s ${i}`);
  }, [i, e, y, f]), (0, import_react.useEffect)(() => (f || H.register(R), () => {
    H.unregister(R);
  }), [R, f]);
  const q = import_react.default.isValidElement(s) ? import_react.default.cloneElement(s, {
    style: {
      ...s.props.style ?? {},
      transform: P,
      willChange: f ? "auto" : "transform",
      transition: k
    },
    ref: $
  }) : null;
  return import_react.default.createElement("div", { ref: j, style: {
    overflow: r ? "visible" : "hidden"
  }, __self: void 0, __source: {
    fileName: J,
    lineNumber: 111,
    columnNumber: 5
  } }, q);
};
export {
  X as default
};
//# sourceMappingURL=simple-parallax-js.js.map
